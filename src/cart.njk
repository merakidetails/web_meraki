---
layout: layout.njk
title: Carrito - Meraki Gift Store
---

<div class="min-h-screen flex flex-col" x-data="{
    whatsAppNumber: '50374446720',
    checkout() {
        let message = '*Hola Meraki!* Me gustaría realizar el siguiente pedido:%0A%0A';
        this.cart.forEach(item => {
            message += `- *${item.title}* ${item.code ? `(Cod: ${item.code})` : ''} x${item.qty} - $${(item.price * item.qty).toFixed(2)}%0A`;
            if(item.customImage) message += `  (Imagen personalizada)%0A`;
        });
        message += `%0A*Total: $${this.cartTotal.toFixed(2)}*`;
        message += `%0A%0AQuedo pendiente de la confirmación. Gracias!`;
        
        window.open(`https://wa.me/${this.whatsAppNumber}?text=${message}`, '_blank');
    }
}">
    <div class="flex-grow max-w-7xl mx-auto px-4 py-10 w-full">
        <nav class="flex mb-8 text-sm text-slate-500">
            <a href="/" class="hover:text-primary">Inicio</a><span class="mx-2">/</span><span class="font-medium text-slate-800 dark:text-slate-200">Carrito</span>
        </nav>
        <h1 class="text-3xl font-bold mb-8">Tu Carrito de Compras</h1>
        
        <div class="lg:grid lg:grid-cols-12 lg:gap-12 items-start" x-show="cart.length > 0">
            <div class="lg:col-span-8 space-y-6">
                <template x-for="item in cart" :key="item.id">
                    <div class="bg-surface-light dark:bg-surface-dark rounded-xl p-4 sm:p-6 shadow-sm border border-slate-100 dark:border-slate-800 flex flex-col sm:row gap-6 hover:shadow-md transition-all">
                        <div class="w-full sm:w-32 h-32 flex-shrink-0 bg-slate-100 rounded-lg overflow-hidden">
                            <img class="w-full h-full object-cover" :src="item.img" :alt="item.title" />
                        </div>
                        <div class="flex-1 flex flex-col justify-between">
                            <div class="flex justify-between items-start">
                                <div><h3 class="text-lg font-semibold" x-text="item.title"></h3></div>
                                <button @click="removeFromCart(item.id)" class="text-slate-400 hover:text-red-500 p-1"><span class="material-icons">delete_outline</span></button>
                            </div>
                            <div class="mt-4 flex justify-between items-end">
                                <div class="flex items-center border border-slate-200 dark:border-slate-700 rounded-lg">
                                    <button @click="updateQty(item.id, -1)" class="px-3 py-1">-</button>
                                    <span class="px-3 py-1 font-medium min-w-[2rem] text-center border-x" x-text="item.qty"></span>
                                    <button @click="updateQty(item.id, 1)" class="px-3 py-1">+</button>
                                </div>
                                <div class="text-right">
                                    <span class="text-xl font-bold text-primary" x-text="'$' + item.price.toFixed(2)"></span>
                                    <span class="block text-xs text-slate-400" x-text="'Total: $' + (item.price * item.qty).toFixed(2)"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </template>
            </div>
            <div class="lg:col-span-4 mt-8 lg:mt-0">
                <div class="bg-surface-highlight-light dark:bg-surface-dark rounded-xl p-6 shadow-lg border border-primary/10 sticky top-24">
                    <h2 class="text-xl font-bold mb-6 pb-4 border-b">Resumen del Pedido</h2>
                    <div class="space-y-4 text-sm text-slate-600 dark:text-slate-300">
                        <div class="flex justify-between"><span>Subtotal</span><span class="font-semibold text-slate-900 dark:text-white" x-text="'$' + cartTotal.toFixed(2)"></span></div>
                        <div class="flex justify-between"><span>Envío estimado</span><span class="font-semibold text-slate-900 dark:text-white">$5.00</span></div>
                    </div>
                    <div class="mt-6 pt-6 border-t flex justify-between items-center">
                        <span class="text-lg font-bold">Total</span>
                        <div class="text-right"><span class="text-2xl font-extrabold text-primary" x-text="'$' + (cartTotal + 5).toFixed(2)"></span></div>
                    </div>
                    <button @click="checkout()" class="w-full mt-8 bg-primary hover:bg-primary-hover text-white py-4 px-6 rounded-xl font-bold shadow-lg transition-transform hover:-translate-y-0.5">Finalizar compra (WhatsApp)</button>
                </div>
            </div>
        </div>
        
        <div x-show="cart.length === 0" class="text-center py-20">
            <span class="material-icons text-6xl text-gray-300 mb-4">shopping_cart</span>
            <h2 class="text-xl font-bold text-gray-500">Tu carrito está vacío</h2>
            <a href="/shop" class="inline-block mt-4 text-primary font-bold hover:underline">Volver a la tienda</a>
        </div>
    </div>
</div>
